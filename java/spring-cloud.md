# spring cloud

## 一、架构演变

### 1. 传统架构

​	在java中使用SSH或者SSM搭建的项目，常规采用MVC架构进行设计，分层开发

	> 存在问题：多人开发，存在代码冲突、任务不好分配、容易产生冲突

### 2.分布式架构

​	基于传统架构演变过来的，将传统的项目以项目模块进行拆分成N多个子项目，比如会员项目、订单项目、支付项目、优惠券项目等等，每个项目中都有自己的独立的数据库、独立的Redis等。

会员项目：登陆、注册、修改密码

订单项目：下单、查询订单、修改订单

* 总结：分布式架构和传统架构区别

 		1.	项目粒度分的更加细致，耦合度降低
 		2.	慢慢开始适合于互联网开发

* maven聚合项目是不是分布式项目：答案是不确定
  * 可以将传统项目，以maven聚合方式分为3个项目，dao/service/web，最终打成一个war包
  * 当项目按照功能进行分割成多个项目，通讯使用RPC进行
  * 最终区别打的jar或war包是多个jvm运行的	

> 项目：包含业务逻辑层和视图层，项目包含前台项目(提供给用户)、后台项目(维护管理)
>
> 服务：只包含业务逻辑层，没有视图层
>
> 中台：管理系统+后台管理系统

### 3.SOA架构

​	业务系统分解为多个组件，让每个组件都独立提供离散，自治，可复用的服务能力

​	通过服务的组合和编排来实现上层的业务流程

​	作用：简化维护,降低整体风险,伸缩灵活

​	SOA架构：面向于服务架构，俗称服务化，是基于分布式架构演变过来的，可以理解为面向于业务逻辑层，将共同的逻辑进行拆分，并抽取出来，提供给其他接口进行调。服务与服务之间通讯采用rpc远程调用技术

​	服务：将共同的业务逻辑进行拆分，拆分成独立一个项目部署，没有视图层，服务概念理解为接口

​	

> RPC远程调用框架：
>
> httpClient、spring cloud、dubbo、grpc
>
> 核心底层socket技术或者netty实现

> WebService 底层采用Http协议+XML(SOAP)
>
> RPC:  远程调用技术，两个或者多个应用实现远程调用

SOA架构特点：

> 底层基于SOAP或者ESB(数据总线)实现的，底层使用http或者https协议+重量级XML数据交换格式进行通讯
>
> 微服务中使用json替代xml，主要区别xml存在很多冗余代码，特别的占用带宽

> SOAP 简单对象协议 http+xml混合 

​	

### 4.微服务架构

1. 微服务架构产生原因

 * SOA架构缺点（微服务架构与SOA架构的区别）
    * SOA架构主要针对企业级、采用ESB服务（ESB企业服务总线），非常重，需要序列化和反序列化，采用XML格式传输
    * 依赖与中心化服务发现机制
    * SOA架构采用SOAP协议(Http+XML),因为XML传输协议比较占用宽带，在整个XML报文中有非常大的冗余数据，所以在微服务架构中以json轻量级方式替代xml报文传输
    * 服务管理非常混乱，缺少服务管理和治理措施不完善

2. 微服务架构模式
   1. 微服务架构是从SOA机构演变过来的，比SOA架构上粒度更加精细。让专业的人做专业的事情(更加专注)，目的是为了提供效率。
   2. 每个服务与服务之间是互不影响，每个服务必须独立部署（独立数据库、独立Redis等），微服务架构更加体现轻量级，采用RESTFUL风格提供API，就是采用http协议+json格式进行传输，更加轻巧，更加适合于互联网公司敏捷开发、快速迭代产品

> 在项目架构中如何保证项目能够支持多来源(移动端、PC端、微信端、小程序端、H5端)访问？
>
> 那么采用微服务架构模式(包含SOA架构)中该如何划分
>
> 划分为： 
>
> ​	WEB控制层 ：控制页面跳转，采用RPC远程调用SOA服务层
>
> ​	SOA服务层：
>
> WEB控制层： 移动端、小程序端、       PC端、微信端、H5端
>
> ​				 
>
> SOA服务层：会员服务、商品服务、支付服务、交易服务、微信服务、优惠券服务